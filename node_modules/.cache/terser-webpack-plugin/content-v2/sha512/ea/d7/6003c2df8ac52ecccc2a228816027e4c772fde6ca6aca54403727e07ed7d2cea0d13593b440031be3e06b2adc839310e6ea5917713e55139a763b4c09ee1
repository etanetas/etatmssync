{"code":"!function(t){function e(e){for(var s,r,f=e[0],l=e[1],o=e[2],m=0,d=[];m<f.length;m++)r=f[m],a[r]&&d.push(a[r][0]),a[r]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);for(c&&c(e);d.length;)d.shift()();return i.push.apply(i,o||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],s=!0,f=1;f<n.length;f++){var l=n[f];0!==a[l]&&(s=!1)}s&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var s={},a={1:0},i=[];function r(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=s,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,\"a\",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p=\"/js/\";var f=window.webpackJsonp=window.webpackJsonp||[],l=f.push.bind(f);f.push=e,f=f.slice();for(var o=0;o<f.length;o++)e(f[o]);var c=l;i.push([34,2]),n()}({14:function(t,e,n){},3:function(t,e,n){},32:function(t,e,n){},34:function(t,e,n){\"use strict\";n.r(e);var s=n(2),a=n.n(s);n(14);function i(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.el=null,this.selectedElement=null,this.selectedClass=\"etatms_searchbox-selected\",this.contentElement=null,this.selectedContent=null,this.content=[]}var e,n,s;return e=t,(n=[{key:\"getContentElement\",value:function(){if(this.contentElement)return this.contentElement;var t=this.el.getElementsByClassName(\"etatms_searchbox-content\");return t?(this.contentElement=t[0],this.contentElement):document.createElement(\"div\")}},{key:\"show\",value:function(){this.getContentElement().classList.add(\"etatms_searchbox-content_show\")}},{key:\"hide\",value:function(){this.getContentElement().classList.remove(\"etatms_searchbox-content_show\")}},{key:\"setSelected\",value:function(t){t&&(this.selectedElement&&this.selectedElement.classList.remove(this.selectedClass),t.classList.add(this.selectedClass),t.scrollIntoView({block:\"nearest\"}),this.selectedElement=t)}},{key:\"setLoading\",value:function(){var t=this.el.getElementsByClassName(\"etatms_searchbox-loading\");t&&t[0].classList.add(\"etatms_searchbox-loading_show\")}},{key:\"unsetLoading\",value:function(){var t=this.el.getElementsByClassName(\"etatms_searchbox-loading\");t&&t[0].classList.remove(\"etatms_searchbox-loading_show\")}},{key:\"selectNext\",value:function(){this.selectedElement&&this.selectedElement.nextSibling?this.setSelected(this.selectedElement.nextSibling):this.content[0]&&this.setSelected(this.content[0].el)}},{key:\"selectPrevious\",value:function(){this.selectedElement&&this.selectedElement.previousSibling?this.setSelected(this.selectedElement.previousSibling):this.content[0]&&this.setSelected(this.content[this.content.length-1].el)}},{key:\"renderContent\",value:function(){var t=this.getContentElement();t.innerHTML=\"\",this.content.length>0&&(this.setSelected(this.content[0].el),this.content.forEach(function(e){t.appendChild(e.el)}))}},{key:\"setPlaceholder\",value:function(t){this.placeHolder=t}},{key:\"setContent\",value:function(t){var e=this,n=this;if(this.content=[],t){var s=0;t.forEach(function(t){var a={};a.el=document.createElement(\"a\"),t.value?(a.el.innerHTML=t.value,a.value=t.value,a.id=t.id):(a.el.innerHTML=t,a.value=t),a.el.setAttribute(\"data-etatms-ind\",s),a.el.addEventListener(\"mouseenter\",function(t){n.setSelected(t.target)}),a.el.addEventListener(\"click\",function(t){var s=t.target.getAttribute(\"data-etatms-ind\");if(s){var a=e.el.getElementsByTagName(\"input\");if(a)a[0].value=e.content[s].value,e.selectedContent=e.content[s],n.hide()}}),n.content.push(a),s++})}this.renderContent()}},{key:\"clear\",value:function(){this.el=null,this.selectedElement=null,this.contentElement=null,this.content=[]}},{key:\"close\",value:function(){this.el.remove(),this.clear()}},{key:\"save\",value:function(){}},{key:\"render\",value:function(t){var e=this;this.clear();var n=(new DOMParser).parseFromString('<div class=\"etatms_searchbox\">\\n  <input type=\"text\" placeholder=\"Search..\" class=\"etatms_searchbox-input\">\\n  <i class=\"fa fa-spinner fa-spin etatms_searchbox-loading\" aria-hidden=\"true\"></i>\\n  <div class=\"etatms_searchbox-content\">\\n  </div>\\n</div>',\"text/html\").getElementsByTagName(\"div\"),s=this;if(n){this.el=n[0];var a=this.el.getElementsByTagName(\"input\");if(a){var i=a[0];this.placeHolder&&(i.placeholder=this.placeHolder),i.addEventListener(\"focus\",function(n){t(n),e.show()}),i.addEventListener(\"keydown\",function(t){switch(t.keyCode){case 38:if(s.getContentElement().classList.contains(\"etatms_searchbox-content_show\")){t.preventDefault(),s.selectPrevious();break}break;case 40:if(s.getContentElement().classList.contains(\"etatms_searchbox-content_show\")){t.preventDefault(),s.selectNext();break}}}),i.addEventListener(\"keyup\",function(n){switch(\"none\"==s.contentElement.style.display&&s.show(),n.keyCode){case 13:var a=e.selectedElement.getAttribute(\"data-etatms-ind\");!e.getContentElement().classList.contains(\"etatms_searchbox-content_show\")&&e.selectedContent&&e.save(),a&&(n.target.value=e.content[a].value,e.selectedContent=e.content[a],s.hide());break;case 38:if(s.getContentElement().classList.contains(\"etatms_searchbox-content_show\"))break;s.show();case 40:if(s.getContentElement().classList.contains(\"etatms_searchbox-content_show\"))break;s.show();case 27:s.getContentElement().classList.contains(\"etatms_searchbox-content_show\")?s.hide():s.close();break;default:t&&t(n,s)}})}}return this.el}}])&&i(e.prototype,n),s&&i(e,s),t}(),f=n(1),l=n.n(f);n(32);function o(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.el=null,this.id=\"\",e.id&&(this.id=e.id),this.name=\"\",e.name&&(this.name=e.name),this.removeEvent=function(t){console.log(\"not implemented\")}}var e,n,s;return e=t,(n=[{key:\"close\",value:function(){this.el.remove()}},{key:\"render\",value:function(){var t=new DOMParser,e=a.a.compile('<div class=\"etatms_tariffs_lmstariff\" data-etatms-lmsid=\"{{id}}\">\\n    {{name}}({{id}}) <div class=\"etatms_button etatms_tariffs_lmstariff_delete\"><i class=\"fa fa-minus\" aria-hidden=\"true\"></i></div>\\n</div>'),n=t.parseFromString(e.render({id:this.id,name:this.name}),\"text/html\").getElementsByTagName(\"div\");n&&(this.el=n[0]);var s=this.el.getElementsByClassName(\"etatms_tariffs_lmstariff_delete\");return s&&s[0].addEventListener(\"click\",this.removeEvent),this.el}}])&&o(e.prototype,n),s&&o(e,s),t}();function m(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var d=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.id=null,this.lmsTariffs=[],this.orig=null,this.trigger=!1,this.el=null}var e,n,s;return e=t,(n=[{key:\"changedLms\",value:function(){return JSON.stringify(this.orig.lmsTariffs)!=JSON.stringify(this.lmsTariffs)}},{key:\"changed\",value:function(){return!1}},{key:\"showCommit\",value:function(){var t=this.el.querySelector(\".etatms_tariffs_tmsbuttons_commit\");t&&t.classList.add(\"etatms_tariffs_tmsbuttons_commit-show\")}},{key:\"hideCommit\",value:function(){var t=this.el.querySelector(\".etatms_tariffs_tmsbuttons_commit\");t&&t.classList.remove(\"etatms_tariffs_tmsbuttons_commit-show\")}}])&&m(e.prototype,n),s&&m(e,s),t}();function u(t,e){if(\"\"==e)return null;for(;t.parentNode&&t.parentNode.classList;){var n=t.parentNode;if(t.parentNode.classList.contains(e))return n;t=n}}function v(t,e,n){var s=null,a=null,i=u(t.target,\"etatms_tariffs_lmstariff\");i&&(s=i.getAttribute(\"data-etatms-lmsid\"));var r=u(t.target,\"etatms_tariffs_row\");r&&(a=r.getAttribute(\"data-etatms-tmsid\")),s?n?h(n,s):a&&e[a]?h(n=e[a],s):console.error(\"Failed to find required tmsRow, tmsid:\".concat(n)):console.error(\"Failed to find required lmsid:\".concat(s))}function h(t,e){if(t){var n=function(t,e){for(var n in t)if(t[n].id==e)return{ind:n,item:t[n]}}(t.lmsTariffs,e);t.lmsTariffs.splice(n.ind,1),n.item.el.remove()}else console.warn(\"Can't find tms tariff\")}function _(t){var e={id:t.syncID,tmsID:t.id,lmsTariffs:t.lmsTariffs},n=t.el.getElementsByClassName(\"etatms_tariffs_tmsbuttons\"),s=null,a=document.createElement(\"i\");return a.classList=\"fa fa-spinner fa-spin\",a.style.marginRight=\"20px\",n&&n[0]&&(s=n[0]).parentNode.replaceChild(a,s),new Promise(function(t,n){l.a.post(\"/?m=etatmssynctariffs&ajax=commit\",e).then(function(e){a.parentNode.replaceChild(s,a),t(e)}).catch(function(t){a.parentNode.replaceChild(s,a),n(t)})})}function p(t,e,n){var s=e.el.getElementsByClassName(\"etatms_tariffs_lmstariff_add\"),a=null;if(s&&s[0]&&(a=s[0]),a){var i=new r,f=document.createElement(\"div\"),o=null,m=e.el.getElementsByClassName(\"etatms_tariffs_lmsids\");m&&m[0]&&(o=m[0]),a.remove(),f.setAttribute(\"data-etatms-addLmsTariff\",\"\"),f.classList=[\"etatms_tariffs_lmstariff\"],f.appendChild(i.render(function(t){!function(t,e,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=\"/?m=etatmssynctariffs&ajax=lmstariffs\";t.target.value&&(a+=\"&q=\".concat(t.target.value)),e.setLoading(),l.a.get(a).then(function(t){t.data&&(n=[],t.data.forEach(function(t){if(s){if(!function(t,e){for(var n in e)if(e[n].id==t)return!0;return!1}(t.id,s)){var e={value:t.name,id:t.id};n.push(e)}}else{var a={value:t.name,id:t.id};n.push(a)}})),e.setContent(n),e.unsetLoading()})}(t,i,n,e.lmsTariffs)})),i.setContent(n);var d=document.createElement(\"i\"),h=function(t){if(i.selectedContent&&i.selectedContent.id){var n=u(f,\"etatms_tariffs_row\");if(n){n.getAttribute(\"data-etatms-tmsid\");!function(t,e,n,s){var a=new c({id:t,name:e});a.removeEvent=function(t){s&&v(t,null,s)};var i=a.render();n.appendChild(i),s&&s.lmsTariffs.push({id:t,name:e,el:i})}(i.selectedContent.id,i.selectedContent.value,o,e),f.remove(),o.appendChild(a)}}};d.classList=[\"fa fa-check etatms_tariffs_lmstariff_add\"],d.addEventListener(\"click\",h),i.save=h,f.appendChild(d);var _=document.createElement(\"i\");_.classList=[\"fa fa-times etatms_tariffs_lmstariff_cancel\"],f.appendChild(_),_.addEventListener(\"click\",function(t){f.remove(),o.appendChild(a)}),o.appendChild(f),i.close=function(t){f.remove(),o.appendChild(a)}}}function g(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,\"value\"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.el=null,this.id=null,this.url=\"/?m=etatmssynctariffs&ajax=tmstariffs\",this.tmsTariffs={updated:0,tariffs:[]},this.lmsTariffs=[],this.tmsTariff=e||new d,this.globalTmsSync=[]}var e,n,s;return e=t,(n=[{key:\"updateTmsTariffs\",value:function(){var t=this,e=this;return new Promise(function(n,s){l.a.get(t.url).then(function(t){var s=new Date;if(t&&t.data){for(var a in e.tmsTariffs.tariffs=[],e.tmsTariffs.updated=s.getTime(),t.data){var i=t.data[a],r={};i.enabled&&(r.id=i.id,r.value=i.tarif_name,e.tmsTariffs.tariffs.push(r))}n(!0)}else n(!1)}).catch(function(t){s(t)})})}},{key:\"commit\",value:function(t){alert(\"Not implemented\")}},{key:\"reset\",value:function(t){alert(\"Not implemented\")}},{key:\"remove\",value:function(t){alert(\"Not implemented\")}},{key:\"save\",value:function(t){alert(\"Not implemented\")}},{key:\"close\",value:function(t){this.tmsTariff.el.remove()}},{key:\"filterTmsTariffs\",value:function(t){var e=[];for(var n in this.tmsTariffs.tariffs){var s=this.tmsTariffs.tariffs[n];new RegExp(\".*\".concat(t,\".*\"),\"i\").test(s.value)&&(this.globalTmsSync[s.id]||e.push(s))}return e}},{key:\"eventAddLmsTariff\",value:function(t,e){p(0,this.tmsTariff.el,this.tmsTariff.lmsTariffs)}},{key:\"renderTariffContent\",value:function(t,e){var n=this,s=\"\\n      \".concat(e,' <div class=\"etatms_tariffs_tmsbuttons\">\\n        <div class=\"etatms_tariffs_tmsbuttons_commit etatms_tariffs_tmsbuttons_commit-show\">\\n          <a href class=\"etatms_tariffs_tmstariff_commit etatms_button\">commit</a>\\n          <a href class=\"etatms_tariffs_tmstariff_reset etatms_button\">reset</a>\\n        </div>\\n        <i class=\"fa fa-minus etatms_tariffs_tmstariff_delete etatms_button\" aria-hidden=\"true\"></i>\\n      </div>\\n    ');t.innerHTML=s;var a=t.getElementsByClassName(\"etatms_tariffs_tmstariff_commit\");a&&a[0]&&a[0].addEventListener(\"click\",function(t){t.preventDefault(),n.commit(t,n.tmsTariff)});var i=t.getElementsByClassName(\"etatms_tariffs_tmstariff_reset\");i&&i[0]&&i[0].addEventListener(\"click\",function(t){t.preventDefault(),n.reset(t)});var r=t.getElementsByClassName(\"etatms_tariffs_tmstariff_delete\");r&&r[0]&&r[0].addEventListener(\"click\",function(t){t.preventDefault(),n.remove(t)})}},{key:\"rerenderLmsTariff\",value:function(){var t=this.tmsTariff.el.querySelector(\".etatms_tariffs_lmstariff_add\"),e=this.tmsTariff.el.querySelector(\".etatms_tariffs_lmsids\");for(var n in e.innerHTML=\"\",this.tmsTariff.lmsTariffs)e.appendChild(this.tmsTariff.lmsTariffs[n].el);e.appendChild(t),this.tmsTariff.hideCommit()}},{key:\"render\",value:function(){var t=this,e=this,n=new DOMParser,s=null,i=null;if(this.tmsTariff.id)s=a.a.compile('<div class=\"etatms_tariffs_row\" data-etatms-tmsname=\"{{name}}\" data-etatms-tmsid=\"{{id}}\" data-etatms-id=\"{{syncID}}\">\\n  <div class=\"etatms_tariffs_tmsid\">\\n    <div class=\"etatms_tariffs_tmsname\">\\n      {{name}}\\n    </div>\\n    <div class=\"etatms_tariffs_tmsbuttons\">\\n      <div class=\"etatms_tariffs_tmsbuttons_commit\">\\n        <a href class=\"etatms_tariffs_tmstariff_save\">commit</a>\\n        <a href class=\"etatms_tariffs_tmstariff_reset\">reset</a>\\n      </div>\\n      <i class=\"fa fa-minus etatms_tariffs_tmstariff_delete etatms_button\" aria-hidden=\"true\"></i>\\n    </div>\\n  </div>\\n  <div class=\"etatms_tariffs_lmsids\" >\\n    <div class=\"etatms_tariffs_lmstariff etatms_tariffs_lmstariff_add etatms_button etatms_button-add\" ><i class=\"fa fa-plus\" aria-hidden=\"true\"></i></div>\\n  </div>\\n</div>'),i=n.parseFromString(s.render({id:this.tmsTariff.id,name:this.tmsTariff.name,syncID:this.tmsTariff.syncID,tariffs:this.tmsTariff.lmsTariffs}),\"text/html\");else{var f=new r;f.close=function(t){e.close()};var l=f.render(function(e){var n=new Date;!t.tmsTariffs.updated||t.tmsTariffs.updated<n-6e4?t.updateTmsTariffs().then(function(n){n&&f.setContent(t.filterTmsTariffs(e.target.value))}).catch(function(t){console.error(t)}):f.setContent(t.filterTmsTariffs(e.target.value))});s=a.a.compile('<div class=\"etatms_tariffs_row\">\\n  <div class=\"etatms_tariffs_tmsid\">\\n    <div class=\"etatms_tariffs_tmsbuttons\">\\n      <i class=\"fa fa-check etatms_tariffs_newtmstariff_save etatms_button\"></i>\\n      <i class=\"fa fa-times etatms_tariffs_newtmstariff_cancel etatms_button\"></i>\\n    </div>\\n  </div>\\n  <div class=\"etatms_tariffs_lmsids\" >\\n     <div class=\"etatms_tariffs_lmstariff etatms_tariffs_lmstariff_add etatms_button etatms_button-add\" ><i class=\"fa fa-plus\" aria-hidden=\"true\"></i></div>\\n  </div>\\n</div>');var o=(i=n.parseFromString(s.render(),\"text/html\")).getElementsByClassName(\"etatms_tariffs_tmsid\");o&&o[0]&&o[0].prepend(l);var c=i.getElementsByClassName(\"etatms_tariffs_newtmstariff_cancel\");c&&c[0]&&c[0].addEventListener(\"click\",function(t){e.close()});var m=function(e){var n=t.tmsTariff.el.getElementsByClassName(\"etatms_tariffs_tmsid\");n&&n[0]&&(t.tmsTariff.id=f.selectedContent.id,t.tmsTariff.name=f.selectedContent.value,t.renderTariffContent(n[0],f.selectedContent.value)),t.save()},d=i.getElementsByClassName(\"etatms_tariffs_newtmstariff_save\");d&&d[0]&&d[0].addEventListener(\"click\",m),f.save=m}this.tmsTariff.el=i.querySelector(\"div\");var u=this.tmsTariff.el.querySelector(\".etatms_tariffs_lmstariff_add\");for(var v in this.tmsTariff.lmsTariffs){var h=this.tmsTariff.lmsTariffs[v];u.parentNode.insertBefore(h.el,u)}if(!this.tmsTariff.id){var _=this.tmsTariff.el.getElementsByClassName(\"etatms_tariffs_lmstariff_add\");_&&_[0]&&_[0].addEventListener(\"click\",function(e){p(0,t.tmsTariff,t.tmsTariff.lmsTariffs)})}return this.tmsTariff.el}}])&&g(e.prototype,n),s&&g(e,s),t}();n(3);window.onload=function(){var t=[];function e(t){return{set:function(e,n,s){return e.changed()||e.changedLms()?t.showCommit():t.hideCommit(),e[n]=s,!0}}}function n(t){return{set:function(e,n,s){return e[n]=s,t.changedLms()||t.changed()?t.showCommit():t.hideCommit(),!0},get:function(t,e){return t[e]}}}var s={},a=null;function i(e){var a=e.el.getElementsByClassName(\"etatms_tariffs_lmstariff_add\");a&&a[0]&&a[0].addEventListener(\"click\",function(n){p(n.target,e,t)});var i=e.el.getElementsByClassName(\"etatms_tariffs_tmstariff_delete\");i&&i[0]&&(i[0].removeEventListener(\"click\",i[0].click),i[0].addEventListener(\"click\",f));var r=e.el.getElementsByClassName(\"etatms_tariffs_lmstariff_delete\");for(var l in r)r[l].tagName&&(r[l].removeEventListener(\"click\",r[l].click),r[l].addEventListener(\"click\",function(t){v(t,s)}));var o=e.el.getElementsByClassName(\"etatms_tariffs_tmstariff_commit\");o&&o[0]&&o[0].addEventListener(\"click\",function(t){!function(t,e){t.preventDefault(),_(e).then(function(t){e.orig.lmsTariffs=Object.assign([],e.lmsTariffs),e.trigger=new Date}).catch(function(t){console.error(t)})}(t,s[e.id])});var c=e.el.getElementsByClassName(\"etatms_tariffs_tmstariff_reset\");c&&c[0]&&c[0].addEventListener(\"click\",function(t){t.preventDefault(),e.lmsTariffs=new Proxy(Object.assign([],e.orig.lmsTariffs),n(e)),new y(e).rerenderLmsTariff()})}function r(t){if(!a){(a=new y).globalTmsSync=s,a.close=function(t){a.tmsTariff.el.remove(),a=null},a.save=function(t){a.tmsTariff&&(s.new=a.tmsTariff)},a.commit=function(t,r){_(r).then(function(t){var f={id:r.id,lmsTariffs:Object.assign([],r.lmsTariffs),el:r.el};r.orig=f,r.lmsTariffs=new Proxy(r.lmsTariffs,n(r)),s[r.id]=new Proxy(Object.assign(new d,r),e(r)),s[r.id].trigger=new Date,t.data.id&&(s[r.id].syncID=t.data.id);var l,o=(l=s[r.id],new y(l).render());r.el.parentNode.replaceChild(o,r.el),s[r.id].el=o,i(s[r.id]),delete s.new,a=null}).catch(function(t){console.error(t)})},a.reset=function(t,e){s.new&&delete s.new,a.tmsTariff.el.remove(),a=null},a.remove=function(t,e){s.new&&delete s.new,a.tmsTariff.el.remove(),a=null};var r=document.querySelector(\".etatms_tariffs_content\");r&&r.prepend(a.render())}}function f(t){var e=null,n=u(t.target,\"etatms_tariffs_row\");n&&(e=n.getAttribute(\"data-etatms-tmsid\")),e&&function(t){var e=s[t].el.getElementsByClassName(\"etatms_tariffs_tmsbuttons\"),n=null,a=null,i=function(){n.innerHTML=a;var t=n.getElementsByClassName(\"etatms_tariffs_tmstariff_delete\");t&&t[0].addEventListener(\"click\",function(t){f(t)})};if(confirm(\"Delete?\")){if(e){n=e[0],a=n.innerHTML,n.innerText=\"\";var r=document.createElement(\"i\");r.classList=\"fa fa-spinner fa-spin\",n.appendChild(r),l.a.post(\"/?m=etatmssynctariffs&ajax=delete\",{id:s[t].syncID}).then(function(e){i(),s[t].el.remove(),delete s[t]}).catch(function(t){i(),alert(\"Server error: \".concat(t))})}setTimeout(function(){},2e3)}}(e)}!function(){var t=document.querySelector(\".etatms_tariffs_tmstariff_add\");t&&t.addEventListener(\"click\",r);var a=document.querySelector(\".etatms_header_syncbutton\");a.addEventListener(\"click\",function(t){a.classList.remove(\"etatms_header_syncbutton_error\"),a.innerHTML;var e=document.createElement(\"i\");e.classList=\"fa fa-spinner fa-spin\",a.prepend(e),a.classList.add(\"button-centered\"),new Promise(function(t,e){l.a.post(\"/?m=etatmssynctariffs&ajax=syncmiddleware\").then(function(e){t()}).catch(function(t){e(t)})}).then(function(t){e.remove()}).catch(function(t){console.log(\"err\"),e.remove(),a.classList.add(\"etatms_header_syncbutton_error\")})});var f=document.querySelectorAll(\".etatms_tariffs_row\");if(f){var o=/\\d+/;for(var c in f)if(o.test(c)){var m=f[c],u=new d,v=m.getAttribute(\"data-etatms-tmsid\");v||console.error(\"Failed to get tms id\");var h=m.getAttribute(\"data-etatms-tmsname\");h||console.error(\"Failed to get tms name\");var _=m.getAttribute(\"data-etatms-id\");_||console.error(\"Failed to get sync id\"),u.el=m,u.id=v,u.syncID=_,u.name=h;var p=[],g=m.getElementsByClassName(\"etatms_tariffs_lmstariff\");for(var y in g)if(g[y]){var b=g[y];if(b.tagName){var T=b.getAttribute(\"data-etatms-lmsid\"),E=b.getAttribute(\"data-etatms-lmsname\");T&&p.push({id:T,name:E,el:b})}}var w=Object.assign({},u);u.orig=w;var C=Object.assign([],p);u.orig.lmsTariffs=C,u.lmsTariffs=new Proxy(p,n(u)),s[v]=new Proxy(u,e(u)),i(u)}}}()}}});","extractedComments":[]}